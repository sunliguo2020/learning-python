# -*- coding: utf-8 -*-
'''
Created on 2016-8-8

@author: sunliguo
'''
import urllib,urllib2,cookielib
import json
import MySQLdb
import time
from urllib2 import URLError

#聂凯userid：8339699
#王建波userid:7217243
#陈忠:2734763

# loginUrl = "http://101.227.240.110:8989/baf/jsp/uiframe/login.jsp"
# logPostUrl = "http://101.227.240.110:8989/jf/login/checkLogin"
# CaptchaUrl = "http://101.227.240.110:8989/servlet/ValidateCodeServlet"
# 
# 
# zhangshangUrl="http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_USER_PROCESS_NUM&v=73&userid=2734763&c=0"
#  
# post1_url = "http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_MID_REAL_DATA&v=73&userid=2734763&c=0"
headers = {
"User-Agent":"Mozilla/5.0 (Linux; Android 4.1.1; G7300 Build/LMY47V; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/45.0.2454.95 Mobile Safari/537.36"
}
cookie = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))
urllib2.install_opener(opener)
 
'''
deviceid :寿光天隆新能源机房01/开关电源01 对应的  设备运维ID
fsuid： 寿光天隆新能源机房01/FSU01 对应的  设备运维ID
'''
# postdata = {
#             "fsuid":"37078343800707",
#             "semaphoreid":"0406112001",
#             "deviceid":"37078340600702"
#             }
#fsuid=&semaphoreid=&deviceid=
#content = urllib2.urlopen(post1_url,urllib.urlencode(postdata))

#print content.read()
def get_zhiliu(fsuid,deviceid):
    #获取精简指标的是post数据
    '''
    fsuid 寿光王望/智能设备    37078343800707     
    寿光孙集齐家村北/智能设备         37078343800698
    寿光孙集齐家村北/开关电源01 37078340600693
    '''
    data2 = {"fsuid":fsuid,
             #"areaid":"DD1AB1779F9C4FE509915D303124F9",
             "start":1,
             "limit":20,
             "type":0,
             "deviceid":deviceid,
             "showflag":0}
    url="http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_FSU_DEVICE_SEMAPHORE_LIST_MONGO&v=73&userid=7217243&c=0"
    #http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_USER_PROCESS_NUM&v=73&userid=7217243&c=0
    #http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_STATION_DEVICE_LIST&v=73&userid=7217243&c=0
    #http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_MID_REAL_DATA&v=73&userid=7217243&c=0
    #print urllib.urlencode(data2)
    try:
        req = urllib2.Request(url,urllib.urlencode(data2),headers)
        content = urllib2.urlopen(req)
        resJson= json.loads(content.read())
    except URLError,e:
        resJson = {}
    #print zhanzhi,",",
    #print "resonse = ",resJson['list']
    if resJson.has_key("list"):
        for i in  resJson['list']:
            if  i['semaphorename'] == u"直流负载总电流":
                return i['semaphoretype'],i['semaphorename'],i['semaphorestatus'],i['measureval']
    else:
        return None

    '''
    返回的数据：
    {"data_info":"正常",
    "currentCount":0,
    "count":49,
    "totalPages":0,
    "currentPage":0,
    "status":"OK",
    "list":[{"semaphorename":"系统额定容量","semaphoreid":"0406122001","semaphorestatus":"正常数据","measureval":"350.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406122001","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电压Uc","semaphoreid":"0406103001","semaphorestatus":"正常数据","measureval":"228.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406103001","semaphoretype":"未知设备"},{"semaphorename":"整流模块9#电流","semaphoreid":"0406113009","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113009","semaphoretype":"未知设备"},{"semaphorename":"蓄电池组数","semaphoreid":"0406126001","semaphorestatus":"正常数据","measureval":"4.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406126001","semaphoretype":"未知设备"},{"semaphorename":"整流模块5#电流","semaphoreid":"0406113005","semaphorestatus":"正常数据","measureval":"7.500000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113005","semaphoretype":"未知设备"},{"semaphorename":"整流模块6#电流","semaphoreid":"0406113006","semaphorestatus":"正常数据","measureval":"7.500000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113006","semaphoretype":"未知设备"},{"semaphorename":"整流模块7#电流","semaphoreid":"0406113007","semaphorestatus":"正常数据","measureval":"7.400000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113007","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电流Ia","semaphoreid":"0406107001","semaphorestatus":"正常数据","measureval":"5.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406107001","semaphoretype":"未知设备"},{"semaphorename":"整流模块8#电流","semaphoreid":"0406113008","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113008","semaphoretype":"未知设备"},{"semaphorename":"整流模块1#电流","semaphoreid":"0406113001","semaphorestatus":"正常数据","measureval":"7.300000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113001","semaphoretype":"未知设备"},{"semaphorename":"整流模块13#温度","semaphoreid":"0406114013","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114013","semaphoretype":"未知设备"},{"semaphorename":"整流模块2#电流","semaphoreid":"0406113002","semaphorestatus":"正常数据","measureval":"7.300000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113002","semaphoretype":"未知设备"},{"semaphorename":"整流模块14#温度","semaphoreid":"0406114014","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114014","semaphoretype":"未知设备"},{"semaphorename":"整流模块3#电流","semaphoreid":"0406113003","semaphorestatus":"正常数据","measureval":"7.100000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113003","semaphoretype":"未知设备"},{"semaphorename":"整流模块15#温度","semaphoreid":"0406114015","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114015","semaphoretype":"未知设备"},{"semaphorename":"整流模块4#电流","semaphoreid":"0406113004","semaphorestatus":"正常数据","measureval":"7.400000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113004","semaphoretype":"未知设备"},{"semaphorename":"整流模块16#温度","semaphoreid":"0406114016","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114016","semaphoretype":"未知设备"},{"semaphorename":"整流模块10#温度","semaphoreid":"0406114010","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114010","semaphoretype":"未知设备"},{"semaphorename":"整流模块11#温度","semaphoreid":"0406114011","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114011","semaphoretype":"未知设备"},{"semaphorename":"整流模块12#温度","semaphoreid":"0406114012","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114012","semaphoretype":"未知设备"},{"semaphorename":"配置模块数量","semaphoreid":"0406123001","semaphorestatus":"正常数据","measureval":"7.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406123001","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电压Ub","semaphoreid":"0406102001","semaphorestatus":"正常数据","measureval":"230.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406102001","semaphoretype":"未知设备"},{"semaphorename":"整流模块16#电流","semaphoreid":"0406113016","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113016","semaphoretype":"未知设备"},{"semaphorename":"整流模块12#电流","semaphoreid":"0406113012","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113012","semaphoretype":"未知设备"},{"semaphorename":"整流模块13#电流","semaphoreid":"0406113013","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113013","semaphoretype":"未知设备"},{"semaphorename":"直流负载总电流","semaphoreid":"0406112001","semaphorestatus":"正常数据","measureval":"55.200001","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406112001","semaphoretype":"未知设备"},{"semaphorename":"整流模块14#电流","semaphoreid":"0406113014","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113014","semaphoretype":"未知设备"},{"semaphorename":"整流模块15#电流","semaphoreid":"0406113015","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113015","semaphoretype":"未知设备"},{"semaphorename":"整流模块10#电流","semaphoreid":"0406113010","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113010","semaphoretype":"未知设备"},{"semaphorename":"整流模块11#电流","semaphoreid":"0406113011","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406113011","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电压Ua","semaphoreid":"0406101001","semaphorestatus":"正常数据","measureval":"224.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406101001","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电流Ic","semaphoreid":"0406109001","semaphorestatus":"正常数据","measureval":"3.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406109001","semaphoretype":"未知设备"},{"semaphorename":"直流电压","semaphoreid":"0406111001","semaphorestatus":"正常数据","measureval":"53.400002","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406111001","semaphoretype":"未知设备"},{"semaphorename":"电池组剩余容量百分比","semaphoreid":"0406130001","semaphorestatus":"正常数据","measureval":"100.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406130001","semaphoretype":"未知设备"},{"semaphorename":"电池组1#电流","semaphoreid":"0406115001","semaphorestatus":"正常数据","measureval":"2.500000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406115001","semaphoretype":"未知设备"},{"semaphorename":"电池组4#温度","semaphoreid":"0406125004","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406125004","semaphoretype":"未知设备"},{"semaphorename":"电池组3#温度","semaphoreid":"0406125003","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406125003","semaphoretype":"未知设备"},{"semaphorename":"电池组2#温度","semaphoreid":"0406125002","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406125002","semaphoretype":"未知设备"},{"semaphorename":"电池组1#温度","semaphoreid":"0406125001","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406125001","semaphoretype":"未知设备"},{"semaphorename":"整流模块6#温度","semaphoreid":"0406114006","semaphorestatus":"正常数据","measureval":"29.200001","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114006","semaphoretype":"未知设备"},{"semaphorename":"整流模块7#温度","semaphoreid":"0406114007","semaphorestatus":"正常数据","measureval":"29.400000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114007","semaphoretype":"未知设备"},{"semaphorename":"交流输入1#相电流Ib","semaphoreid":"0406108001","semaphorestatus":"正常数据","measureval":"3.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406108001","semaphoretype":"未知设备"},{"semaphorename":"整流模块8#温度","semaphoreid":"0406114008","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114008","semaphoretype":"未知设备"},{"semaphorename":"整流模块9#温度","semaphoreid":"0406114009","semaphorestatus":"正常数据","measureval":"0.000000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114009","semaphoretype":"未知设备"},{"semaphorename":"整流模块2#温度","semaphoreid":"0406114002","semaphorestatus":"正常数据","measureval":"29.500000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114002","semaphoretype":"未知设备"},{"semaphorename":"整流模块3#温度","semaphoreid":"0406114003","semaphorestatus":"正常数据","measureval":"29.600000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114003","semaphoretype":"未知设备"},{"semaphorename":"整流模块4#温度","semaphoreid":"0406114004","semaphorestatus":"正常数据","measureval":"28.900000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114004","semaphoretype":"未知设备"},{"semaphorename":"整流模块5#温度","semaphoreid":"0406114005","semaphorestatus":"正常数据","measureval":"29.299999","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114005","semaphoretype":"未知设备"},{"semaphorename":"整流模块1#温度","semaphoreid":"0406114001","semaphorestatus":"正常数据","measureval":"29.400000","datatime":"2016-08-11","id":"37078343800707_37078340600702_0406114001","semaphoretype":"未知设备"}]}
    
    '''

def GET_BASE_STATION_LIST():
    '''
                           动环监控中的 站址列表
    '''
    url = "http://101.227.253.208:58090/itower/mobile/app/service?porttype=GET_BASE_STATION_LIST&v=73&userid=7217243&c=0"
    postdata ={
               "start":1,
               "limit":20
               }
    req = urllib2.Request(url,urllib.urlencode(postdata))
    content = urllib2.urlopen(req)
    #print content.read()
    postJson = json.loads(content.read())
    for k in postJson['stationList']:
        for i,j in  k.iteritems():
            print i,j
        print "#"*50
        
        
    '''返回实例：
    {"data_info":"正常",
    "currentCount":20,
    "count":9776,
    "totalPages":489,
    "currentPage":1,
    "status":"OK",
    "stationList":[{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":1,"st_code":"37070200000003","devicecount":8,"st_type":"室内宏站","st_lat":36.61614,"st_maintenance_person_names":"潍城付为刚,潍坊监控中心1,李晓波","st_deliverdate":"2015-06-28","st_maintenance_roompersonid":"2739150,10013800,0810472","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":118.95061,"st_maintenance_personid":"2739150,10013800,0810472","st_name":"潍城尹家庄子村东南","st_type_dictvalue":"1","st_maintenance_roomperson":"潍城付为刚,潍坊监控中心1,李晓波","st_address":"潍城区尹家庄子村村南","st_id":"0607845","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.622176845346","baidux":"118.96270942556","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":2,"st_code":"37070200000005","devicecount":11,"st_type":"室内宏站","st_lat":36.667099,"st_maintenance_person_names":"潍坊监控中心1,李晓波,邮电马强","st_deliverdate":"2015-12-01","st_maintenance_roompersonid":"2739150,10013800,0810472","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.095901,"st_maintenance_personid":"10013800,0810472,2742824","st_name":"潍城花卉大世界","st_type_dictvalue":"1","st_maintenance_roomperson":"邮电闫永林,潍坊监控中心1,李晓波","st_address":"潍城区宝通街青年路交叉口花卉大世界","st_id":"7131065","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.67322","baidux":"119.1084","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":3,"st_code":"37070200000006","devicecount":5,"st_type":"室内宏站","st_lat":36.727852,"st_maintenance_person_names":"潍城付为刚,潍坊监控中心1,李晓波","st_deliverdate":"2015-10-01","st_maintenance_roompersonid":"2739150,10013800,0810472","st_status":"工程","st_provinceid":"山东分公司","fsuonlinecount":0,"st_lon":119.016716,"st_maintenance_personid":"2739150,10013800,0810472","st_name":"潍城军埠口花乡生态园","st_type_dictvalue":"1","st_maintenance_roomperson":"潍城付为刚,潍坊监控中心1,李晓波","st_address":"军埠口花乡生态园","st_id":"7197785","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"1","baiduy":"36.99660","baidux":"118.9119","st_countyid":"潍城区","status":"1"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":4,"st_code":"37070200000007","devicecount":12,"st_type":"室内宏站","st_lat":0.367478,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-19","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"测试","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":1.190474,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍城大正养殖","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍城大正养殖","st_id":"8850503","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"6","baiduy":"0.3734833874895988","baidux":"1.1969803247047406","st_countyid":"潍城区","status":"6"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":5,"st_code":"37070200000008","devicecount":10,"st_type":"室内宏站","st_lat":36.734382,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-01","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.054716,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊东七甲2","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城外商投资开发东七甲张村委会","st_id":"8867593","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.741047007444","baidux":"119.06709765289","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":6,"st_code":"37070200000009","devicecount":12,"st_type":"室内宏站","st_lat":36.7374,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-21","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.088295,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊清河湾","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊清河湾","st_id":"9035982","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.743595162450426","baidux":"119.10088366678346","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":7,"st_code":"37070200000010","devicecount":11,"st_type":"室内宏站","st_lat":36.723598,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-02","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.079796,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"山东潍坊潍城基督教堂站点","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"山东潍坊潍城基督教堂站点","st_id":"9036983","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.729853982140476","baidux":"119.09234005358663","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":8,"st_code":"37070200000011","devicecount":10,"st_type":"室内宏站","st_lat":36.728397,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-09","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.0298,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊焦家","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍潍彩虹路工业3路路口东行路南焦家村村委","st_id":"9232460","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.735175499254304","baidux":"119.04204209892647","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":9,"st_code":"37070200000012","devicecount":10,"st_type":"室内宏站","st_lat":36.687199,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-09","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.062393,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊潍城美城食品园","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城宝通街278号","st_id":"9232978","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.69369705659846","baidux":"119.07479166651741","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":10,"st_code":"37070200000013","devicecount":11,"st_type":"室内宏站","st_lat":36.728397,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-31","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.099098,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊郭家庄子","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊郭家庄子","st_id":"9501854","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.734582836949514","baidux":"119.11168330358228","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":11,"st_code":"37070200000014","devicecount":10,"st_type":"室内宏站","st_lat":36.723499,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":118.962898,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"粱宏机械厂","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"粱宏机械厂","st_id":"9596777","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.729438116537644","baidux":"118.97508642618482","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":12,"st_code":"37070200000015","devicecount":10,"st_type":"室内宏站","st_lat":36.72029,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"测试","st_provinceid":"山东分公司","fsuonlinecount":0,"st_lon":119.07951,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊潍城圣基铭座","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城圣基铭座","st_id":"9596778","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"6","baiduy":"36.72654623","baidux":"119.09204893","st_countyid":"潍城区","status":"6"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":13,"st_code":"37070200000016","devicecount":11,"st_type":"室内宏站","st_lat":36.7174,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.029297,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊豪德南","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊豪德南","st_id":"9596779","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.724164377882666","baidux":"119.0415261563025","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":14,"st_code":"37070200000017","devicecount":10,"st_type":"室内宏站","st_lat":36.722099,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.060402,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍城实验中学","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城实验中学","st_id":"9596780","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.72865977403669","baidux":"119.07281067063317","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":15,"st_code":"37070200000018","devicecount":9,"st_type":"室内宏站","st_lat":36.672501,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.0411,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍城顺达运输","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城顺达运输","st_id":"9596781","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.67925173800901","baidux":"119.05335633510377","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":16,"st_code":"37070200000019","devicecount":10,"st_type":"室内宏站","st_lat":36.7001,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"测试","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.076401,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍城舜天燃料","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城舜天燃料","st_id":"9596782","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"6","baiduy":"36.70637850789971","baidux":"119.08890337816486","st_countyid":"潍城区","status":"6"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":17,"st_code":"37070200000020","devicecount":10,"st_type":"室内宏站","st_lat":36.75499,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"测试","st_provinceid":"山东分公司","fsuonlinecount":0,"st_lon":119.02488,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊滨河花园","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊滨河花园","st_id":"9596783","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"6","baiduy":"36.76174361","baidux":"119.03712764","st_countyid":"潍城区","status":"6"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":18,"st_code":"37070200000022","devicecount":10,"st_type":"室内宏站","st_lat":36.752098,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":118.963493,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊潍城高埠","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"高埠","st_id":"9596785","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.75805610068854","baidux":"118.9757037441826","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":19,"st_code":"37070200000023","devicecount":11,"st_type":"室内宏站","st_lat":36.684601,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.069298,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍坊潍城东风机械厂","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城东风机械厂","st_id":"9596786","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.69097941339462","baidux":"119.08174923119995","st_countyid":"潍城区","status":"2"},{"st_cityid":"潍坊分公司","st_areamanager":"0259076","rownum_":20,"st_code":"37070200000024","devicecount":9,"st_type":"室内宏站","st_lat":36.742798,"st_maintenance_person_names":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_deliverdate":"2015-12-10","st_maintenance_roompersonid":"8477582,10013800,10013956,7258087","st_status":"交维","st_provinceid":"山东分公司","fsuonlinecount":1,"st_lon":119.098694,"st_maintenance_personid":"8477582,10013800,10013956,7258087","st_name":"潍城东夏庄小学","st_type_dictvalue":"1","st_maintenance_roomperson":"宜通张国伟,潍坊监控中心1,潍坊监控中心2,宜通王云红","st_address":"潍坊潍城东夏庄小学","st_id":"9596787","st_areamanager_name":"鲁振强","fsucount":1,"st_status_dictvalue":"2","baiduy":"36.74899438350114","baidux":"119.11129093385506","st_countyid":"潍城区","status":"2"}]}

    '''

def zhiliu2sql ():
    conn = MySQLdb.connect(host="127.0.0.1",db="tieta",user="root",passwd="",charset="utf8")
    cur = conn.cursor()
    cur.execute("select tieta_id,zhanzhi_name,fsu_id,switch_id from tietaid")
    result = cur.fetchall()
    for i in result:
        print i[1]
        zhiliu_result = get_zhiliu(i[2],i[3])
        print "zhiliu_result=",zhiliu_result
        if zhiliu_result:
            curtime=time.strftime("%Y-%m-%d %H:%M:%S")
            value= (curtime,i[0],i[1])+zhiliu_result
            cur.execute("insert into zhiliu values('%s','%s','%s','%s','%s','%s','%s')" % value)
    
    
if __name__ == "__main__":
    #GET_BASE_STATION_LIST()
    zhiliu2sql()